<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
  </head>
  <body>
    <div id="d_2"><span>1</span>2<span>b</span>3</div>
    <div id="d_2"><span>1</span>23</div>
    <div id="d_1"><span>a</span>123</div>
    <div id="d0"><span>a</span>12<span></span>3</div>
    <div id="d1">123</div>
    <div id="d2">12<span></span>3</div>
    <div id="d3">1<span>2</span>3</div>
  </body>
  <script src="../tools/VerifyXpath.js"></script>
  <script>
    const examples = [
      "//div[text()='123']",
      "//*[text()='12']",
      "//*[text()='1']",
      "//*[string()='123']",
      "//div[text()='23']",
      "//div[text()='2']"
    ];

    examples.forEach((xpath, index) => {
      console.log(`\n示例 ${index + 1}: ${xpath}`);
      const elements = VerifyXpath(xpath);
      console.log(`找到 ${elements.length} 个元素:`);
      console.log(elements);
      elements.forEach((el) => {
        // console.log(`  - ${el.outerHTML.substring(0, 100)}...`);
      });
      console.log('------');
    });

    const d1 = document.getElementById('d1');
    const d2 = document.getElementById('d2');
    const d3 = document.getElementById('d3');

    // 获取第一个文本节点的函数
    function getFirstTextNode(element) {
      // childNodes 包含所有类型的节点，包括文本节点和元素节点
      for (let node of element.childNodes) {
        if (node.nodeType === Node.TEXT_NODE && node.nodeValue.trim() !== '') {
          return node;
        }
      }
      return null;
    }

    // 或者如果只想获取第一个子节点（无论是否为空文本），可以这样：
    function getFirstTextNodeRaw(element) {
      for (let node of element.childNodes) {
        if (node.nodeType === Node.TEXT_NODE) {
          return node;
        }
      }
      return null;
    }

    // 使用第一个函数（忽略空白文本节点）
    const firstTextNode1 = getFirstTextNode(d1);
    const firstTextNode2 = getFirstTextNode(d2);
    const firstTextNode3 = getFirstTextNode(d3);

    console.log('d1第一个文本节点:', firstTextNode1 ? firstTextNode1.nodeValue : '无');
    console.log('d2第一个文本节点:', firstTextNode2 ? firstTextNode2.nodeValue : '无');
    console.log('d3第一个文本节点:', firstTextNode3 ? firstTextNode3.nodeValue : '无');
  </script>
</html>
